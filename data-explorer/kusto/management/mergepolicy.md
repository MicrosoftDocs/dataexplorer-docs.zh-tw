---
title: 擴展區合併策略 - Azure 資料資源管理員 |微軟文件
description: 本文介紹 Azure 資料資源管理器中的擴展區合併策略。
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 02/19/2020
ms.openlocfilehash: 771af22f07a770b0da1196871e9132393524aab9
ms.sourcegitcommit: 47a002b7032a05ef67c4e5e12de7720062645e9e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/15/2020
ms.locfileid: "81520718"
---
# <a name="extents-merge-policy"></a>擴充區合併政策
合併策略定義庫斯特托群集中的[範圍(資料碎片)](../management/extents-overview.md)是否以及如何合併。

合併操作有兩種類型:(`Merge`重建索引)`Rebuild`和 (完全重新引入資料)。

這兩種操作類型都具有單個範圍,從而替換源擴展盤區。

默認情況下,優先選擇重建操作,並且僅當有任何剩餘擴展盤區不符合重建條件時,才會嘗試合併這些擴展盤區。  

*注意：*
- 使用*不同*`drop-by`標記標記擴展區將導致此類擴展區不會合併在一起,即使已設置合併策略(請參閱[範圍標記](../management/extents-overview.md#extent-tagging))。
- 標記聯合超過 1M 字元長度的擴展盤區將不會合併在一起。
- 資料庫/表的[分片策略](./shardingpolicy.md)對擴展盤區如何合併在一起也產生了一些影響。

合併政策包含以下屬性:

- **行計數上邊界合併**:
    - 預設為 0。
    - 合併範圍的最大允許行計數。
    - 應用於合併操作,而不是重新生成。  
- **最大範圍合併**:
    - 默認值為 100。
    - 允許在單個操作中合併的最大範圍數。
    - 應用於合併操作。
- **循環週期**:
    - 默認值為 01:00:00(1 小時)。
    - 在開始合併/重建操作的連續反覆運算之間等待的最大時間(由資料管理服務執行)。
    - 同時應用於合併和重新生成操作。
- **允許重建**:
    - 默認值為"true"。
    - 定義是否`Rebuild`啟用操作(在這種情況下,它們優先`Merge`於操作)。
- **允許合併**:
    - 默認值為"true"。
    - 定義是否`Merge`啟用操作(在這種情況下,操作`Rebuild`比 操作更不可取)。
- **馬克斯蘭因小時**:
    - 默認值為 8。
    - 任意 2 個不同範圍的創建時間之間的最大允許差異(以小時表示),以便它們仍可以合併。
    - 時間戳是創建範圍的,與範圍中包含的實際數據無關。
    - 同時應用於合併和重新生成操作。
    - 最佳做法是此值與資料庫/表的[保留策略](./retentionpolicy.md)的*SoftDelete 週期*或[緩存策略](./cachepolicy.md)的*DataHotSpan(* 兩者中的較低部分)相關,以便介於後者的 2-3% 之間。

**`MaxRangeInHours`範例:**
|最小(軟刪除期(保留策略),資料熱跨度(快取策略))|最大範圍(以小時表示)(合併策略)
|---|---
|7 天 (168 小時)| 4
|14 天(336 小時)| 8
|30 天(720 小時)| 18
|60 天(1,440 小時)| 36
|90 天(2,160 小時)| 60
|180 天(4,320 小時)| 120
|365天(8,760小時)| 250

> [!WARNING]
> 很少建議在不事先諮詢 Kusto 團隊的情況下更改範圍合併策略。

創建資料庫時,使用預設 Merge 策略(具有上述預設值的策略)設定該策略,預設情況下,該策略由資料庫中創建的所有表繼承(除非其策略在表級別顯式覆蓋)。

控制項指令,允許管理資料庫/表的合併策略[,可以在這裡](../management/merge-policy.md)找到。